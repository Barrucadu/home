## -*- shell-script -*-

# Environmental Variables
export PATH="$PATH:/usr/local/bin:/usr/local/sbin:/home/barrucadu/bin"
export BROWSER=/usr/bin/opera
export EDITOR=emacs
export VISUAL=emacs
export PAGER=/usr/bin/most
export ACK_PAGER=$PAGER
export HISTFILE=~/.data/zsh/history
export HISTSIZE=1000
export SAVEHIST=1000
export DIRSTACKSIZE=16
export XDG_CACHE_HOME=~/.cache
export XDG_CONFIG_HOME=~/.config
export XDG_DATA_HOME=~/.data
export QT_XFT=1
export GDK_USE_XFT=1
export WEBKIT_IGNORE_SSL_ERRORS=1
export NETHACKOPTIONS=@/home/barrucadu/.config/nethack/config
export SCHEME_LIBRARY_PATH=/usr/lib/slib/
export LANG=en_GB.UTF-8
export LC_ALL=en_GB.UTF-8
export LC_CTYPE=C
export LD_PRELOAD=libetc.so
export LIBETC_BLACKLIST="/bin/ls:/bin/mv:/bin/cp:/bin/ln:/usr/bin/find:/bin/rm:/bin/cat:/bin/ln:/usr/bin/file:/usr/bin/most:/bin/zcat:/bin/grep:/usr/bin/git:/usr/bin/git-cvsserver:/usr/bin/git-receive-pack:/usr/bin/git-shell:/usr/bin/git-upload-archive:/usr/bin/git-upload-pack:/usr/bin/gitk"
export LIBETC_DATA="/home/barrucadu/.gtk-bookmarks"
export LIBETC_IGNORE="/home/barrucadu/.icons:/home/barrucadu/.themes:/home/barrucadu/.signature:/home/barrucadu/.git:/home/barrucadu/.gitignore:/home/barrucadu/.gitconfig"
export NMPC_DEFCMD="nmpcfunc status"
export NMPC_DEFHELP="all"

# Framebuffer colours
if [ "$TERM" = "linux" ]; then
    echo -en "\e]P0121212"
    echo -en "\e]P8262626"
    echo -en "\e]P1ff4500"
    echo -en "\e]P9ff7f00"
    echo -en "\e]P2698b69"
    echo -en "\e]PA00ee76"
    echo -en "\e]P3ffd700"
    echo -en "\e]PBffff00"
    echo -en "\e]P468838b"
    echo -en "\e]PC00bfff"
    echo -en "\e]P5c71585"
    echo -en "\e]PDda70d6"
    echo -en "\e]P67fffd4"
    echo -en "\e]PEadd8e6"
    echo -en "\e]P7fffff0"
    echo -en "\e]PFf5fffa"
    clear
fi

# Terminal colours
autoload colors zsh/terminfo
if [[ "$terminfo[colors]" -ge 8 ]]; then
	colors
fi

for color in RED GREEN YELLOW BLUE MAGENTA CYAN WHITE; do
	eval PR_$color='$terminfo[bold]$fg[${(L)color}]'
	eval PR_LIGHT_$color='$fg[${(L)color}]'

	(( count = $count + 1 ))

	export PR_$color
	export PR_LIGHT_$color
done

export PR_NO_COLOR="$terminfo[sgr0]"

# Shell prompt
export PROMPT="${PR_LIGHT_GREEN}%* ${PR_GREEN}%%${PR_NO_COLOR} "

# Emacs shell mode
[[ $EMACS = t ]] && unsetopt zle

# Keybindings - I'm not actually sure which ones are required.
bindkey "\e[1~"  beginning-of-line
bindkey "\e[4~"  end-of-line
bindkey "\e[5~"  beginning-of-history
bindkey "\e[6~"  end-of-history
bindkey "\e[3~"  delete-char
bindkey "\e[2~"  quoted-insert
bindkey "\e[5C"  forward-word
bindkey "\eOc"   emacs-forward-word
bindkey "\e[5D"  backward-word
bindkey "\eOd"   emacs-backward-word
bindkey "\e\e[C" forward-word
bindkey "\e\e[D" backward-word
bindkey "^H"     backward-delete-word
bindkey "\e[8~"  end-of-line
bindkey "\e[7~"  beginning-of-line
bindkey "\eOH"   beginning-of-line
bindkey "\eOF"   end-of-line
bindkey "\e[H"   beginning-of-line
bindkey "\e[F"   end-of-line
bindkey '^i'     expand-or-complete-prefix

# Colourful Directory Listings
eval `dircolors -b`

# Tab Completion
zle -C complete-file complete-word _generic

zstyle ':completion:*'                 completer _complete _match _approximate
zstyle ':completion:*:match:*'         original only
zstyle ':completion:*:approximate:*'   max-errors 1 numeric
zstyle ':completion:*:*'               original only
zstyle ':completion:complete-file::::' completer _files
zstyle ':completion:*'                 completer _complete _ignored _files

autoload -Uz compinit
compinit

# Misc Settings
setopt hist_ignore_all_dups hist_ignore_space extended_history
setopt autocd
setopt extendedglob
setopt correct correctall
setopt autopushd pushdminus pushdsilent pushdtohome
