## -*- shell-script -*-

# Run and disown a program
function r()
{
    $* &>/dev/null &
    disown %%
}

# Run and disown a program, then terminate the shell
function re()
{
    $* &>/dev/null &
    disown %%
    exit
}

# Run a program with the grp environment
function grprun() {
    local GRPDIR=${GRPDIR:-/tmp/hacksoc-grp}

    PATH=$GRPDIR/bin:$PATH \
    LD_LIBRARY_PATH=$GRPDIR/lib:$LD_LIBRARY_PATH \
    PYTHONPATH=$GRPDIR/lib/python3.3/site-packages:$PYTHONPATH \
    $*
}

# List a directory, restricting by some regex, and tabulate the result.
function lsby() {
    local regex=$1
    shift
    ls $* | grep $regex | column -c `tput cols`
}

# Short alias for stack, with abbreviated subcommands.
function s() {
  local command=$1
  shift

  case "$command" in
    b) stack build   $* ;;
    B) stack bench   $* ;;
    c) stack clean   $* ;;
    e) stack exec    $* ;;
    g) stack ghci    $* ;;
    i) stack install $* ;;
    t) stack test    $* ;;
    "-h" | "--help")
      echo "s: shorthand for 'stack"
      echo "USAGE: s <command or alias> <args>\n"
      echo "Aliases:\n"
      echo "    b: build"
      echo "    B: bench"
      echo "    c: clean"
      echo "    e: exec"
      echo "    g: ghci"
      echo "    i: install"
      echo "    t: test\n"
      echo "For stack help, see 'stack --help'"
      ;;
    *) stack $command $* ;;
  esac
}
