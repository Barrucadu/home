#!/bin/zsh

media=true
share=true
torrents=true
http=true
sudocmd=sudo

[[ "$UID" == "0" ]] && sudocmd=''

function parsearg()
{
    case $1 in
        "nomedia")
            media=false;;
        "noshare")
            share=false;;
        "notorrents")
            torrents=false;;
        "nohttp")
            http=false;;
    esac
}

function eimount ()
{
    $sudocmd mount -t nfs4 eihort:/$1 /share/$2
}

function eiumount ()
{
    $sudocmd umount /share/$1
}

for arg in "${*[@]}"; do
    parsearg $arg
done

if ! mount | grep -q eihort; then
    $share    && eimount share    eihort
    $media    && eimount media    eihort-media
    $torrents && eimount torrents eihort-torrents
    $http     && eimount http     eihort-http
else
    $share    && eiumount eihort
    $media    && eiumount eihort-media
    $torrents && eiumount eihort-torrents
    $http     && eiumount eihort-http
fi
