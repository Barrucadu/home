#!/bin/bash

MOVIEPATH=`[ "$MOVIEPATH" = "" ] && echo "/home/barrucadu/video/movies" || echo $MOVIEPATH`

function help ()
{
    echo "moviedb: A tool to manage and query the filesystem movie database"
    echo
    echo "Usage: moviedb <command> <arg1> <arg2> <arg3> ... <argn>"
    echo
    echo "Commands:"
    echo "    add   : Add a new movie to the database."
    echo "    lists : Manage and use movie playlists."
    echo "    menu  : Launch the dmenu-based movie menu."
    echo "    play  : Play movies."
    echo "    query : Search for movies."
    echo "See the individual command help for more details."
    echo 
    echo "Return codes:"
    echo "    1 = Unknown command."

    echo "Maintainer: Michael Walker"
}

if [[ -d $MOVIEPATH/by-director ]] && [[ -d $MOVIEPATH/by-genre ]]; then
    cmd=$1

    case $cmd in
        "add" | "lists" | "menu" | "play" | "query")
            shift && moviedb-$cmd $*;;
        "" | "help")
            help;;
        *)
            echo "Unknown command $cmd"
            return 1;;
    esac
else
    echo "\$MOVIEPATH = $MOVIEPATH"
    echo "\$MOVIEPATH/by-director or \$MOVIEPATH/by-genre does not appear to exist."
    return 3
fi
