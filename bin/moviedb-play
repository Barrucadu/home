#!/bin/zsh

MOVIEPATH=`[ "$MOVIEPATH" = "" ] && echo "/home/barrucadu/video/movies" || echo $MOVIEPATH`

function play ()
{
    file="`moviedb-query file $*`"

    if [[ -e $file ]]; then
	vlc $file &>/dev/null &
    else
	return 1
    fi
}

function help ()
{
    echo "moviedb-play: A tool to play movies in the filesystem database."
    echo
    echo "Usage: moviedb-play <movie>"
    echo
    echo "Return codes:"
    echo "    1 = Cannot find movie."
    echo "    2 = Missing movie folder(s)."
    echo
    echo "Maintainer: Michael Walker"
}

if [[ -d $MOVIEPATH/by-director ]] && [[ -d $MOVIEPATH/by-genre ]]; then
    case $1 in
        "" | "help")
            help;;
        *)
            play $*
    esac
else
    echo "\$MOVIEPATH = $MOVIEPATH"
    echo "\$MOVIEPATH/by-director or \$MOVIEPATH/by-genre does not appear to exist."
    return 1
fi
